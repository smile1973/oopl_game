# 2025 OOPL Final Report

## 組別資訊

組別： 31
組員： 
- 111820024 廖翊宏
- 111820030 楊承諭

復刻遊戲：Rabbit and Steel

## 專案簡介

### 遊戲簡介

### 組別分工
111820024 廖翊宏：
- 遊戲主架構 (App.cpp, main.cpp)
- 角色系統 (Character.cpp)
- 敵人系統 (Enemy.cpp) 
- UI系統 (LevelUI, HealthBarUI, ShopUI, DefeatScreen)
- 遊戲階段管理 (PhaseManager)
- 物件碰撞系統 (Collides.cpp)

111820030 楊承諭：
- 完整特效系統 (Effect目錄下所有內容)
- 完整攻擊系統 (Attack目錄下所有內容)
- 攻擊模式工廠 (AttackPatternFactory)
- 部分角色功能
- 技能實作

## 遊戲介紹

### 遊戲規則

1. 角色移動
   - 上移：按下 ↑ (上方向鍵)
   - 下移：按下 ↓ (下方向鍵)
   - 左移：按下 ← (左方向鍵)
   - 右移：按下 → (右方向鍵)
      - 兔子角色會在遊戲畫面設定的邊界內移動，不會超出範圍。

   ---

2. 技能使用
   - 技能 1：按下並鬆開 Z 鍵
      - 如果技能可以使用，兔子會對半徑 200 單位內的敵人造成 10 點傷害。
      - 如果技能 X 處於啟用狀態，則額外造成 1000 點傷害。
   - 技能 2：按下並鬆開 X 鍵
      - 如果技能可以使用，兔子會對掃過路徑上的敵人造成 $5 \times \text{兔子等級}$ 點傷害。
   - 技能 3：按下並鬆開 C 鍵
      - 如果技能可以使用，兔子立即移動到敵人身旁的位置，並對敵人造成 $5 \times \text{兔子等級}$ 點傷害。
      - 如果技能 X 處於啟用狀態，則額外造成 1000 點傷害。
   - 技能 4：按下並鬆開 V 鍵
      - 如果技能可以使用，兔子會進入無敵狀態2秒。
   ---

3. 遊戲互動
   - 暫停/確認選擇：在暫停選單和結算畫面中，按下 N 鍵可以選擇選項或確認動作。
   - 暫停選單導航：
      - 上一個選項：按下並鬆開 ↑ (上方向鍵)
      - 下一個選項：按下並鬆開 ↓ (下方向鍵)
   - 商店選單導航：
      - 上一個商品：按下並鬆開 ← (左方向鍵)
      - 下一個商品：按下並鬆開 → (右方向鍵)
      - 購買商品：在商店介面，按下並鬆開 N 鍵。
         - 購買商品 0 (治療)：花費 5 金幣，如果生命條未滿，則補滿生命。
         - 購買商品 1 (經驗)：花費 5 金幣，獲得 100 經驗值(升 1 級)。
   - 離開商店：在商店介面，按下並鬆開 E 鍵。
   - 與商人互動：當商人可見時，按下並鬆開 R 鍵可以打開商店介面。
   - 進入下一階段/關卡：當所有敵人被擊敗且「前進」圖示可見時，讓兔子碰撞到「前進」圖示即可進入下一階段。
   - 重玩遊戲：在暫停選單、勝利畫面或戰敗畫面中選擇「新遊戲」選項。

   ---

4. 遊戲狀態
   - 退出遊戲：在遊戲進行過程中，按下 ESC 鍵或觸發遊戲退出條件。
   - 進入上帝模式 (測試用)：按下並鬆開 G 鍵可以切換上帝模式（無敵狀態）。

   ---

5. 遊戲流程（簡要）
   1. 準備階段：遊戲開始時，玩家需要按下 Z 鍵讓兔子進入起始位置。
   2. 遊戲進行：
      - 擊敗敵人以獲得經驗值或金錢。
      - 透過碰撞「前進」圖示進入下一階段。
      - 在商店階段，可以購買物品。
      - 在寶藏階段，可以獲得獎勵。
   3. 戰敗：當兔子生命值歸零時，遊戲進入戰敗畫面，玩家可以選擇重新開始或退出遊戲。
   4. 勝利：通過所有關卡，遊戲進入勝利畫面，玩家可以選擇重新開始或退出遊戲。

---

## 遊戲畫面

![圖片的替代文字](Resources/Image/GameScreen/螢幕擷取畫面%202025-06-06%20151900.png "遊戲進行畫面")

![圖片的替代文字](Resources/Image/GameScreen/螢幕擷取畫面%202025-06-06%20153113.png "商店畫面")

![圖片的替代文字](Resources/Image/GameScreen/螢幕擷取畫面%202025-06-06%20152241.png "勝利畫面")

![圖片的替代文字](Resources/Image/GameScreen/螢幕擷取畫面%202025-06-06%20152843.png "戰敗畫面")





## 程式設計

### 程式架構
本專案採用物件導向設計，主要架構包含：

1. **主程式架構**
   - App類別：使用單例模式管理整個遊戲的狀態機(START, UPDATE, END)
   - PhaseManager：管理遊戲中的不同階段轉換

2. **遊戲物件系統**
   - Object基礎類別：所有遊戲物件的基底類別
   - Character：玩家角色類別，管理移動、技能、血量等
   - Enemy：敵人類別，包含不同的攻擊模式和AI行為
   - Skill：技能系統，支援動畫播放和冷卻時間管理

3. **攻擊與特效系統**
   - AttackManager：管理所有攻擊物件的生命週期
   - AttackPattern：攻擊模式的基礎類別
   - AttackPatternFactory：使用工廠模式產生各種攻擊模式
   - EffectManager：管理遊戲中所有視覺特效
   - CompositeEffect：組合模式實現複雜特效

4. **UI系統**
   - HealthBarUI：玩家血條顯示
   - SkillUI：技能冷卻時間顯示
   - LevelUI：關卡資訊顯示
   - ShopUI：商店介面
   - DefeatScreen：失敗(勝利)畫面

### 程式技術
1. **設計模式應用**
   - 單例模式(Singleton)：App、EffectManager、AttackManager
   - 工廠模式(Factory)：AttackPatternFactory、EffectFactory
   - 組合模式(Composite)：CompositeEffect用於組合多個特效

2. **遊戲開發技術**
   - 物件池(Object Pooling)：用於優化大量彈幕的生成與回收
   - 狀態機(State Machine)：管理角色和技能的狀態轉換
   - 碰撞檢測：實現精確的彈幕判定系統

## 結語

### 問題與解決方法
1. **彈幕效能優化問題**
   - 問題：大量彈幕同時存在時造成FPS下降
   - 解決：實作物件池機制，重複使用攻擊物件，減少記憶體配置

2. **攻擊模式同步問題**
   - 問題：多個敵人的攻擊時機難以協調
   - 解決：使用AttackController統一管理攻擊時序

3. **特效層級顯示問題**
   - 問題：特效與遊戲物件的渲染順序混亂
   - 解決：實作層級管理系統，確保正確的繪製順序

### 自評

| 項次   | 項目                                    | 完成                |
| ----- | ---------------------------------------- | ------------------ |
| 1     | 基本角色移動與技能系統                      |   ✅              |
| 2     | 敵人 AI 與攻擊模式實作                     |   ✅               |
| 3     | 彈幕系統與碰撞判定機制                      |   ✅              |
| 4     | 視覺特效系統（動畫、特效組合）              |   ✅               |
| 5     | UI 介面（血條、技能冷卻、階段提示）          |   ✅              |
| 6     | 音效與背景音樂整合                         |   ⛔               |
| 7     | 商店系統與購買機制                         |   ✅               |
| 8     | 多階段關卡流程與進度管理                    |   ✅              |
| 9     | 勝利/戰敗/暫停畫面邏輯                     |   ✅               |
| 10    | 遊戲狀態管理（開始、進行、結束）             |   ✅              |
| 11    | 上帝模式（除錯用快捷鍵）                    |   ✅              |
| 12    | 技能冷卻與狀態機管理                       |   ✅               |
| 13    | 使用物件導向設計架構良好                    |   ✅              |
| 14    | 效能優化（Object Pooling）                 |   ✅              |
| 15    | 繪圖層級管理與顯示順序正確                  |   ✅              |
| 16    | 測試與除錯（技能/特效/邏輯）                |   ✅              |
| 17    | 程式可維護性與模組化                       |   ✅               |
| 18    | 錯誤處理與容錯機制                         |   ⛔               |
| 19    | 商店與角色等級經驗值邏輯平衡                |   ✅               |
| 20    | 資料與數值參數設定合理                      |   ✅              |
| 21    | 測試關卡與挑戰性設計                        |   ✅              |
| 22    | 專案分工明確且協作順利                      |   ✅              |


### 心得

組員 111820024 廖翊宏 的心得：
這次的專案對我來說是一個非常寶貴的學習機會。在實作遊戲主架構、角色與敵人系統以及 UI 介面的過程中，我更深入地理解了物件導向設計的實踐應用，特別是如何透過清晰的模組化來管理複雜的程式碼。處理碰撞系統和遊戲階段管理也讓我學會了如何在遊戲邏輯層面確保各個部分之間的協同運作。雖然過程中也遇到了一些挑戰，例如如何讓各個系統之間順暢地互動，但透過不斷地測試與調整，最終都成功解決了。這次經驗讓我對於遊戲開發的整體流程有了更全面的認識，也提升了我的程式設計能力。


組員 111820030 楊承諭 的心得：
透過這次專案，我們深入學習了遊戲開發的各個面向，從基礎的物件導向設計到進階的效能優化技術。特別是在實作彈幕系統時，體會到了設計模式的重要性，以及如何在效能與功能之間取得平衡。團隊合作方面，我們學會了如何有效分工，並透過良好的程式架構讓雙方的程式碼能夠順利整合。

### 貢獻比例
- 111820024 廖翊宏：50%
- 111820030 楊承諭：50%